(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-99bed730"],{b06d:function(e,t,r){"use strict";r.r(t);r("b0c0");var a=r("7a23"),c=Object(a["createVNode"])("header",{class:"mb-5"},[Object(a["createVNode"])("h1",{class:"mb-3"},"訂單管理")],-1),o={class:"d-flex justify-content-between align-items-center mt-3 mb-5"},d=Object(a["createVNode"])("i",{class:"bi bi-trash-fill me-2"},null,-1),s=Object(a["createTextVNode"])(" 刪除全部訂單 "),l={class:"input-group w-25 align-items-center border rounded-3"},i=Object(a["createVNode"])("div",{class:"input-text px-3"},[Object(a["createVNode"])("i",{class:"bi bi-search"})],-1),n={class:"input-group w-auto align-items-center"},b=Object(a["createVNode"])("label",{for:"sort",class:"me-2"},"排序",-1),O=Object(a["createVNode"])("option",{selected:"",value:""},"日期由新到舊（預設）",-1),p={key:0,class:"alert alert-danger border-0"},u={class:"nav nav-pills mb-3"},h={class:"nav-item"},j={class:"nav-item"},m={class:"nav-item"},f={class:"table-responsive"},g={class:"table table-borderless table-hover table-striped"},V=Object(a["createVNode"])("thead",null,[Object(a["createVNode"])("tr",null,[Object(a["createVNode"])("th",{scope:"col"},"訂單編號"),Object(a["createVNode"])("th",{scope:"col"},"聯絡人 / 電話"),Object(a["createVNode"])("th",{scope:"col"},"電子郵件"),Object(a["createVNode"])("th",{scope:"col"},"應付金額"),Object(a["createVNode"])("th",{scope:"col"},"訂單日期"),Object(a["createVNode"])("th",{scope:"col"},"訂單狀態"),Object(a["createVNode"])("th",{scope:"col",class:"text-end"},"檢視 / 刪除")])],-1),N={scope:"row"},y={key:0},v=Object(a["createVNode"])("i",{class:"bi bi-person-fill me-2 text-muted"},null,-1),k=Object(a["createVNode"])("br",null,null,-1),B=Object(a["createVNode"])("i",{class:"bi bi-telephone-fill me-2 text-muted"},null,-1),S={key:1},M={key:2},w={key:3},x={class:"text-end"},D={class:"btn-group",role:"group","aria-label":"Basic mixed styles example"},L={key:1,class:"text-center text-muted"},$={key:0},C={key:1};function _(e,t,r,_,F,T){var R=Object(a["resolveComponent"])("Loading"),U=Object(a["resolveComponent"])("Pagination"),P=Object(a["resolveComponent"])("OrderModal"),E=Object(a["resolveComponent"])("DelOrderModal");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])(R,{active:F.isLoading,"z-index":100,loader:"dots",color:"#384D48"},null,8,["active"]),c,Object(a["createVNode"])("div",o,[Object(a["createVNode"])("button",{type:"button",class:["btn btn-outline-danger border-0",{disabled:!F.orders.length}],onClick:t[1]||(t[1]=function(t){return T.openModal("delete",e.item)})},[d,s],2),Object(a["createVNode"])("div",l,[i,Object(a["withDirectives"])(Object(a["createVNode"])("input",{type:"search","onUpdate:modelValue":t[2]||(t[2]=function(e){return F.orderSearchBar=e}),placeholder:"搜尋訂單編號",class:"form-control border-0 flex-shrink-0"},null,512),[[a["vModelText"],F.orderSearchBar,void 0,{trim:!0}]])]),Object(a["createVNode"])("div",n,[b,Object(a["withDirectives"])(Object(a["createVNode"])("select",{class:"form-select","aria-label":"select","onUpdate:modelValue":t[3]||(t[3]=function(e){return F.sortBy=e}),id:"sort"},[O,Object(a["createVNode"])("option",{value:"createdFromOldest",disabled:!F.orders.length},"日期由舊到新",8,["disabled"]),Object(a["createVNode"])("option",{value:"totalFromHighest",disabled:!F.orders.length},"金額由高至低",8,["disabled"]),Object(a["createVNode"])("option",{value:"totalFromLowest",disabled:!F.orders.length},"金額由低至高",8,["disabled"])],512),[[a["vModelSelect"],F.sortBy]])])]),F.orderSearchBar&&F.searchResults?(Object(a["openBlock"])(),Object(a["createBlock"])("div",p,Object(a["toDisplayString"])(F.searchResults),1)):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])("ul",u,[Object(a["createVNode"])("li",h,[Object(a["createVNode"])("a",{class:["nav-link rounded-pill",{active:""===F.filterBy}],href:"#",onClick:t[4]||(t[4]=Object(a["withModifiers"])((function(e){return T.getOrders(1,"allOrders")}),["prevent"]))}," 所有訂單 ",2)]),Object(a["createVNode"])("li",j,[Object(a["createVNode"])("a",{class:["nav-link rounded-pill",{active:"paid"===F.filterBy}],href:"#",onClick:t[5]||(t[5]=Object(a["withModifiers"])((function(e){return T.filterData("paid")}),["prevent"]))}," 已付款 ",2)]),Object(a["createVNode"])("li",m,[Object(a["createVNode"])("a",{class:["nav-link rounded-pill",{active:"unpaid"===F.filterBy}],href:"#",onClick:t[6]||(t[6]=Object(a["withModifiers"])((function(e){return T.filterData("unpaid")}),["prevent"]))}," 未付款 ",2)])]),Object(a["createVNode"])("div",f,[Object(a["createVNode"])("table",g,[V,Object(a["createVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(F.orders,(function(t){return Object(a["openBlock"])(),Object(a["createBlock"])("tr",{key:t.id},[Object(a["createVNode"])("td",N,Object(a["toDisplayString"])(t.id),1),t.user?(Object(a["openBlock"])(),Object(a["createBlock"])("td",y,[v,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(t.user.name)+" ",1),k,B,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(t.user.tel),1)])):(Object(a["openBlock"])(),Object(a["createBlock"])("td",S," 無 ")),t.user?(Object(a["openBlock"])(),Object(a["createBlock"])("td",M,Object(a["toDisplayString"])(t.user.email),1)):(Object(a["openBlock"])(),Object(a["createBlock"])("td",w,"無")),Object(a["createVNode"])("td",null," $"+Object(a["toDisplayString"])(e.$filters.currency(t.total)),1),Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.$filters.date(t.create_at)),1),Object(a["createVNode"])("td",{class:t.is_paid?"text-success":"text-muted"},Object(a["toDisplayString"])(t.is_paid?"已付款":"未付款"),3),Object(a["createVNode"])("td",x,[Object(a["createVNode"])("div",D,[Object(a["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary border-0 bi bi-eye-fill",onClick:function(e){return T.openModal("edit",t)}},null,8,["onClick"]),Object(a["createVNode"])("button",{type:"button",class:"btn btn-outline-danger border-0 bi bi-trash-fill",onClick:function(e){return T.openModal("delete",t)}},null,8,["onClick"])])])])})),128))])])]),""===F.filterBy||F.orders.length?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])("p",L,["unpaid"===F.filterBy?(Object(a["openBlock"])(),Object(a["createBlock"])("span",$,"無未付款訂單")):"paid"===F.filterBy?(Object(a["openBlock"])(),Object(a["createBlock"])("span",C,"無已付款訂單")):Object(a["createCommentVNode"])("",!0)])),Object(a["createVNode"])(U,{pagination:F.pagination,onChangePage:T.getOrders},null,8,["pagination","onChangePage"]),Object(a["createVNode"])(P,{"temp-order":F.tempOrder,ref:"orderModal",onUpdate:T.getOrders},null,8,["temp-order","onUpdate"]),Object(a["createVNode"])(E,{"temp-order":F.tempOrder,ref:"delOrderModal",onDelete:T.getOrders},null,8,["temp-order","onDelete"])],64)}var F=r("5530"),T=(r("99af"),r("159b"),r("4de4"),r("caad"),r("2532"),r("1799")),R={class:"modal fade",id:"orderModal",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true",ref:"modal"},U={class:"modal-dialog modal-xl"},P={class:"modal-content"},E=Object(a["createVNode"])("div",{class:"modal-header border-0"},[Object(a["createVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"}," 訂單細節 "),Object(a["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),H={class:"modal-body"},J={class:"row"},q={class:"col-sm-4"},z={class:"p-3 bg-light rounded-3"},A=Object(a["createVNode"])("h3",{class:"h5"},"用戶資料",-1),G={class:"table"},I={key:0},K=Object(a["createVNode"])("th",{scope:"row"},"姓名",-1),Q=Object(a["createVNode"])("th",{scope:"row"},"電話",-1),W=Object(a["createVNode"])("th",{scope:"row"},"地址",-1),X=Object(a["createVNode"])("th",{scope:"row"},"Email",-1),Y={class:"col-sm-8"},Z={class:"p-3 bg-light rounded-3 mb-4"},ee=Object(a["createVNode"])("h3",{class:"h5"},"訂單資訊",-1),te={class:"table"},re=Object(a["createVNode"])("th",{scope:"row"},"訂單日期",-1),ae=Object(a["createVNode"])("th",{scope:"row"},"訂單編號",-1),ce=Object(a["createVNode"])("th",{scope:"row"},"總金額",-1),oe={key:0},de=Object(a["createVNode"])("th",{scope:"row"},"付款時間",-1),se={class:"p-3 bg-light rounded-3 mb-4"},le=Object(a["createVNode"])("h3",{class:"h5"},"訂單品項",-1),ie={class:"table"},ne={key:0},be={scope:"row"},Oe=Object(a["createVNode"])("h3",{class:"h5"},"付款狀態",-1),pe={class:"modal-footer border-0"},ue=Object(a["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function he(e,t,r,c,o,d){var s=Object(a["resolveComponent"])("Loading");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])(s,{active:o.isLoading},null,8,["active"]),Object(a["createVNode"])("div",R,[Object(a["createVNode"])("div",U,[Object(a["createVNode"])("div",P,[E,Object(a["createVNode"])("div",H,[Object(a["createVNode"])("div",J,[Object(a["createVNode"])("div",q,[Object(a["createVNode"])("div",z,[A,Object(a["createVNode"])("table",G,[e.tempOrder.user?(Object(a["openBlock"])(),Object(a["createBlock"])("tbody",I,[Object(a["createVNode"])("tr",null,[K,Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.tempOrder.user.name),1)]),Object(a["createVNode"])("tr",null,[Q,Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.tempOrder.user.tel),1)]),Object(a["createVNode"])("tr",null,[W,Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.tempOrder.user.address),1)]),Object(a["createVNode"])("tr",null,[X,Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.tempOrder.user.email),1)])])):Object(a["createCommentVNode"])("",!0)])])]),Object(a["createVNode"])("div",Y,[Object(a["createVNode"])("div",Z,[ee,Object(a["createVNode"])("table",te,[Object(a["createVNode"])("tbody",null,[Object(a["createVNode"])("tr",null,[re,Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.$filters.date(e.tempOrder.create_at)),1)]),Object(a["createVNode"])("tr",null,[ae,Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.tempOrder.id),1)]),Object(a["createVNode"])("tr",null,[ce,Object(a["createVNode"])("td",null,"$ "+Object(a["toDisplayString"])(e.tempOrder.total),1)]),e.tempOrder.is_paid?(Object(a["openBlock"])(),Object(a["createBlock"])("tr",oe,[de,Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.$filters.date(e.tempOrder.paid_date)),1)])):Object(a["createCommentVNode"])("",!0)])])]),Object(a["createVNode"])("div",se,[le,Object(a["createVNode"])("table",ie,[e.tempOrder.products?(Object(a["openBlock"])(),Object(a["createBlock"])("tbody",ne,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.tempOrder.products,(function(t){return Object(a["openBlock"])(),Object(a["createBlock"])("tr",{key:t.id},[Object(a["createVNode"])("th",be,Object(a["toDisplayString"])(t.product.title),1),Object(a["createVNode"])("td",null," x "+Object(a["toDisplayString"])(t.qty),1),Object(a["createVNode"])("td",null," $"+Object(a["toDisplayString"])(e.$filters.currency(t.total)),1)])})),128))])):Object(a["createCommentVNode"])("",!0)])]),Oe,Object(a["withDirectives"])(Object(a["createVNode"])("input",{type:"checkbox",id:"is_paid",checked:e.tempOrder.is_paid,class:"me-2","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tempOrder.is_paid=t})},null,8,["checked"]),[[a["vModelCheckbox"],e.tempOrder.is_paid]]),Object(a["createVNode"])("label",{for:"is_paid",class:["form-label",e.tempOrder.is_paid?"text-success":"text-muted"]},Object(a["toDisplayString"])(e.tempOrder.is_paid?"已付款":"未付款"),3)])]),Object(a["createVNode"])("div",pe,[ue,Object(a["createVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[2]||(t[2]=function(){return d.updateOrder&&d.updateOrder.apply(d,arguments)})},"確認")])])])])],512)],64)}var je=r("e0ae"),me={props:["temp-order"],emits:["update"],inject:["$httpMessageState"],template:"#orderModal",data:function(){return{modal:null,isLoading:!1}},mixins:[je["a"]],methods:{openModal:function(){this.modal.show()},updateOrder:function(){var e=this;this.isLoading=!0;var t=this.tempOrder.id,r="/api/".concat("hsinyuuu","/admin/order/").concat(t);this.$http.put(r,{data:this.tempOrder}).then((function(t){if(!t.data.success)return e.$httpMessageState(t,"修改訂單"),void(e.isLoading=!1);e.modal.hide(),e.$emit("update"),e.$httpMessageState(t,"修改訂單"),e.isLoading=!1})).catch((function(t){e.$httpMessageState(t,"連線錯誤"),e.isLoading=!1}))}}},fe=r("6b0d"),ge=r.n(fe);const Ve=ge()(me,[["render",he]]);var Ne=Ve,ye={class:"modal fade",id:"delOrderModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},ve={class:"modal-dialog"},ke={class:"modal-content"},Be=Object(a["createVNode"])("div",{class:"modal-header border-0"},[Object(a["createVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},"刪除訂單"),Object(a["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Se={class:"modal-body"},Me=Object(a["createTextVNode"])(" 確定要刪除編號： "),we={key:0,class:"fw-bold"},xe={key:1,class:"fw-bold"},De=Object(a["createTextVNode"])(" 訂單嗎？ "),Le=Object(a["createVNode"])("div",{class:"alert alert-danger py-2",role:"alert"},[Object(a["createVNode"])("i",{class:"bi bi-exclamation-triangle me-2"}),Object(a["createTextVNode"])(" 刪除後即無法恢復 ")],-1),$e={class:"modal-footer border-0"},Ce=Object(a["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function _e(e,t,r,c,o,d){return Object(a["openBlock"])(),Object(a["createBlock"])("div",ye,[Object(a["createVNode"])("div",ve,[Object(a["createVNode"])("div",ke,[Be,Object(a["createVNode"])("div",Se,[Object(a["createVNode"])("p",null,[Me,e.tempOrder.id?(Object(a["openBlock"])(),Object(a["createBlock"])("span",we,Object(a["toDisplayString"])(e.tempOrder.id),1)):(Object(a["openBlock"])(),Object(a["createBlock"])("span",xe," 全部 ")),De]),Le]),Object(a["createVNode"])("div",$e,[Ce,Object(a["createVNode"])("button",{type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=function(){return d.deleteOrder&&d.deleteOrder.apply(d,arguments)})},"刪除")])])])],512)}var Fe={props:["temp-order"],emits:["delete"],template:"#delOrderModal",data:function(){return{modal:null,isLoading:!1}},mixins:[je["a"]],inject:["$httpMessageState"],methods:{openModal:function(){this.modal.show()},deleteOrder:function(){var e=this;this.isLoading=!0;var t,r=this.tempOrder.id;t=r?"/api/".concat("hsinyuuu","/admin/order/").concat(r):"/api/".concat("hsinyuuu","/admin/orders/all"),this.$http.delete(t,{data:this.tempOrder}).then((function(t){if(!t.data.success)return e.$httpMessageState(t,"刪除訂單"),void(e.isLoading=!1);e.modal.hide(),e.$emit("delete"),e.$httpMessageState(t,"刪除訂單"),e.isLoading=!1})).catch((function(t){e.$httpMessageState(t,"連線錯誤"),e.isLoading=!1}))}}};const Te=ge()(Fe,[["render",_e]]);var Re=Te,Ue={components:{Pagination:T["a"],OrderModal:Ne,DelOrderModal:Re},data:function(){return{orders:[],tempOrder:{},pagination:"",loadingStatus:{},current_page:1,isLoading:!1,orderSearchBar:"",searchResults:"",allOrders:[],sortBy:"",filterBy:"",filtedOrders:"",sortedOrders:"",matchOrders:""}},inject:["$httpMessageState"],methods:{getOrders:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current_page,r=arguments.length>1?arguments[1]:void 0;if(""===this.pagination||"allOrders"!==r){this.isLoading=!0;var a="/api/".concat("hsinyuuu","/admin/orders?page=").concat(t);this.$http.get(a).then((function(t){if(!t.data.success)return e.$httpMessageState(t,"取得訂單"),void(e.isLoading=!1);if(e.orders=t.data.orders,e.pagination=t.data.pagination,e.current_page=t.data.pagination.current_page,e.filterBy="",e.filtedOrders="",e.matchOrders="",e.allOrders=[],e.orders.forEach((function(t){e.allOrders.push(t)})),e.pagination.total_pages>1)for(var r=2;r<=e.pagination.total_pages;r+=1)e.$http.get("/api/".concat("hsinyuuu","/admin/orders?page=").concat(r)).then((function(r){if(!r.data.success)return e.$httpMessageState(t,"取得訂單"),void(e.isLoading=!1);var a=r.data.orders;a.forEach((function(t){e.allOrders.push(t)})),""!==e.orderSearchBar&&e.searchOrders(),""!==e.sortedOrders&&e.sortOrders(e.sortBy)}));e.isLoading=!1})).catch((function(t){e.$httpMessageState(t,"連線錯誤"),e.isLoading=!1}))}},openModal:function(e,t){switch(e){case"edit":this.tempOrder=Object(F["a"])({},t),this.$refs.orderModal.openModal();break;case"delete":this.tempOrder=Object(F["a"])({},t),this.$refs.delOrderModal.openModal();break;default:break}},searchOrders:function(){var e=this;this.matchOrders=this.allOrders.filter((function(t){return t.id.toLowerCase().includes(e.orderSearchBar.toLowerCase())})),this.matchOrders.length?(this.searchResults="",this.orders=this.matchOrders,this.sortedOrders?this.sortOrders(this.sortBy):(this.sortBy="",this.sortedOrders=""),this.filterBy="",this.filtedOrders="",this.pagination=""):this.searchResults="無符合搜尋結果，請再試試其他關鍵字～"},sortOrders:function(e){var t=[];switch(this.pagination="",t=this.filtedOrders?this.filtedOrders:this.matchOrders?this.matchOrders:this.allOrders,e){case"totalFromLowest":t.sort((function(e,t){return e.total-t.total}));break;case"totalFromHighest":t.sort((function(e,t){return t.total-e.total}));break;case"createdFromOldest":t.sort((function(e,t){return e.create_at-t.create_at}));break;default:break}this.sortedOrders=t,this.orders=this.sortedOrders},filterData:function(e){if(this.filterBy!==e){this.pagination="",this.filterBy=e;var t=[];switch(t=this.matchOrders?this.matchOrders:this.allOrders,e){case"paid":this.filtedOrders=t.filter((function(e){return e.is_paid}));break;case"unpaid":this.filtedOrders=t.filter((function(e){return!e.is_paid}));break;default:break}this.sortedOrders?this.sortOrders(this.sortBy):this.orders=this.filtedOrders}}},watch:{sortBy:function(e,t){e===t?"totalFromLowest"!==e&&"totalFromHighest"!==e||this.sortOrders(e):""===e?(this.sortedOrders="",this.getOrders()):this.sortOrders(e)},orderSearchBar:function(e){""!==e?this.searchOrders():this.getOrders()}},mounted:function(){this.$http.defaults.baseURL="https://vue3-course-api.hexschool.io",this.getOrders()}};const Pe=ge()(Ue,[["render",_]]);t["default"]=Pe},b0c0:function(e,t,r){var a=r("83ab"),c=r("9bf2").f,o=Function.prototype,d=o.toString,s=/^\s*function ([^ (]*)/,l="name";a&&!(l in o)&&c(o,l,{configurable:!0,get:function(){try{return d.call(this).match(s)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-99bed730.11fce420.js.map