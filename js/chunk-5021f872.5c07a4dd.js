(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5021f872"],{"1dde":function(e,t,c){var a=c("d039"),r=c("b622"),o=c("2d00"),s=r("species");e.exports=function(e){return o>=51||!a((function(){var t=[],c=t.constructor={};return c[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"4de4":function(e,t,c){"use strict";var a=c("23e7"),r=c("b727").filter,o=c("1dde"),s=o("filter");a({target:"Array",proto:!0,forced:!s},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"65f0":function(e,t,c){var a=c("861d"),r=c("e8b5"),o=c("b622"),s=o("species");e.exports=function(e,t){var c;return r(e)&&(c=e.constructor,"function"!=typeof c||c!==Array&&!r(c.prototype)?a(c)&&(c=c[s],null===c&&(c=void 0)):c=void 0),new(void 0===c?Array:c)(0===t?0:t)}},b0c0:function(e,t,c){var a=c("83ab"),r=c("9bf2").f,o=Function.prototype,s=o.toString,l=/^\s*function ([^ (]*)/,i="name";a&&!(i in o)&&r(o,i,{configurable:!0,get:function(){try{return s.call(this).match(l)[1]}catch(e){return""}}})},b64b:function(e,t,c){var a=c("23e7"),r=c("7b0b"),o=c("df75"),s=c("d039"),l=s((function(){o(1)}));a({target:"Object",stat:!0,forced:l},{keys:function(e){return o(r(e))}})},b727:function(e,t,c){var a=c("0366"),r=c("44ad"),o=c("7b0b"),s=c("50c4"),l=c("65f0"),i=[].push,n=function(e){var t=1==e,c=2==e,n=3==e,d=4==e,b=6==e,u=7==e,m=5==e||b;return function(p,f,O,j){for(var V,g,N=o(p),v=r(N),h=a(f,O,3),x=s(v.length),y=0,w=j||l,k=t?w(p,x):c||u?w(p,0):void 0;x>y;y++)if((m||y in v)&&(V=v[y],g=h(V,y,N),e))if(t)k[y]=g;else if(g)switch(e){case 3:return!0;case 5:return V;case 6:return y;case 2:i.call(k,V)}else switch(e){case 4:return!1;case 7:i.call(k,V)}return b?-1:n||d?d:k}};e.exports={forEach:n(0),map:n(1),filter:n(2),some:n(3),every:n(4),find:n(5),findIndex:n(6),filterOut:n(7)}},cb07:function(e,t,c){"use strict";c.r(t);c("b0c0"),c("b64b");var a=c("7a23"),r={class:"position-relative bg-light"},o={class:"container pt-5"},s=Object(a["createStaticVNode"])('<div class="row d-lg-none mb-5"><div class="col-md-10 mx-auto"><ol class="row progress-bar list-unstyled justify-content-between text-center"><li class="col-4 done">確認購物車品項</li><li class="col-4 active">填寫資料</li><li class="col-4">確認訂單並付款</li></ol></div></div>',1),l={class:"row flex-lg-row-reverse gx-5 pb-5 mb-5"},i={class:"col-lg-4 mb-4"},n={class:"bg-light sticky-lg-top"},d=Object(a["createVNode"])("h2",{class:"fs-4 text-primary d-none d-lg-block mb-3"},[Object(a["createVNode"])("i",{class:"bi bi-card-text"}),Object(a["createTextVNode"])(" 訂單細節 ")],-1),b={class:"accordion-item bg-transparent border-0"},u=Object(a["createVNode"])("h2",{class:"accordion-header order-info-header",id:"headingOne"},[Object(a["createVNode"])("button",{class:"accordion-button shadow-sm text-primary fw-bold fs-4",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne"},[Object(a["createVNode"])("i",{class:"bi bi-card-text me-2"}),Object(a["createTextVNode"])(" 訂單細節 ")])],-1),m={id:"collapseOne",class:"order-info accordion-collapse collapse","aria-labelledby":"headingOne"},p={class:"accordion-body px-0 py-lg-0"},f={key:0,class:"carts list-group list-group-flush"},O={class:"card-body d-flex flex-column justify-content-between py-0 pe-0"},j={class:"d-flex justify-content-between align-items-center"},V={class:"card-title h6"},g={key:0,class:"text-primary bg-info rounded-pill py-1 px-2 badge"},N=Object(a["createVNode"])("i",{class:"bi bi-tag-fill"},null,-1),v={class:"d-flex justify-content-between"},h={class:"card-text d-inline-block fw-bold mb-0"},x={class:"card-text d-inline-block fw-bold mb-0"},y={class:"row text-primary align-items-center"},w=Object(a["createVNode"])("dt",{class:"col-3"},"運費",-1),k=Object(a["createVNode"])("dd",{class:"col-9 text-end fw-bold"},"$0",-1),S={key:0,class:"col-3 text-nowrap"},B=Object(a["createVNode"])("i",{class:"bi bi-tag-fill text-primary"},null,-1),$=Object(a["createTextVNode"])(" 折扣後合計 "),C={key:1,class:"col-3"},T={class:"col-9 text-end fs-5 fw-bold mb-0"},L={class:"col-lg-8"},M=Object(a["createVNode"])("h1",{class:"fs-4 text-primary mb-3"},[Object(a["createVNode"])("i",{class:"bi bi-pen-fill"}),Object(a["createTextVNode"])(" 訂購人資訊 ")],-1),E={class:"bg-white shadow rounded-3 py-5 px-3 px-md-5"},D=Object(a["createStaticVNode"])('<div class="row d-none d-lg-block mb-5"><div class="col-md-10 mx-auto"><ol class="row progress-bar list-unstyled justify-content-between text-center"><li class="col-4 done">確認購物車品項</li><li class="col-4 active">填寫資料</li><li class="col-4">確認訂單並付款</li></ol></div></div>',1),F=Object(a["createVNode"])("p",{class:"text-danger"},"* 為必填欄位",-1),U={class:"mb-3"},A=Object(a["createVNode"])("label",{for:"email",class:"form-label"},[Object(a["createTextVNode"])(" Email "),Object(a["createVNode"])("span",{class:"text-danger"},"*")],-1),q={class:"mb-3"},_=Object(a["createVNode"])("label",{for:"name",class:"form-label"},[Object(a["createTextVNode"])(" 姓名 "),Object(a["createVNode"])("span",{class:"text-danger"},"*")],-1),I={class:"mb-3"},J=Object(a["createVNode"])("label",{for:"tel",class:"form-label"},[Object(a["createTextVNode"])(" 電話 "),Object(a["createVNode"])("span",{class:"text-danger"},"*")],-1),z={class:"mb-3"},G=Object(a["createVNode"])("label",{for:"address",class:"form-label"},[Object(a["createTextVNode"])(" 地址 "),Object(a["createVNode"])("span",{class:"text-danger"},"*")],-1),R={class:"mb-3"},H=Object(a["createVNode"])("label",{for:"message",class:"form-label"},"留言",-1),K=Object(a["createVNode"])("span",{class:"invalid-feedback"},null,-1),P=Object(a["createVNode"])("p",{class:"text-danger text-end small"},[Object(a["createVNode"])("i",{class:"bi bi-exclamation-circle"}),Object(a["createTextVNode"])(" 提醒：送出後即無法修改資料，敬請確認後再送出！ ")],-1),Q={class:"d-flex justify-content-between"},W=Object(a["createVNode"])("i",{class:"bi bi-caret-left-fill"},null,-1),X=Object(a["createTextVNode"])(" 上一步 "),Y=Object(a["createTextVNode"])(" 確認資料並送出 "),Z=Object(a["createVNode"])("i",{class:"bi bi-caret-right-fill"},null,-1);function ee(e,t,c,ee,te,ce){var ae=Object(a["resolveComponent"])("Loading"),re=Object(a["resolveComponent"])("router-link"),oe=Object(a["resolveComponent"])("Field"),se=Object(a["resolveComponent"])("ErrorMessage"),le=Object(a["resolveComponent"])("Form");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])(ae,{active:te.isLoading,"z-index":100,loader:"dots",color:"#384D48"},null,8,["active"]),Object(a["createVNode"])("div",r,[Object(a["createVNode"])("div",o,[s,Object(a["createVNode"])("div",l,[Object(a["createVNode"])("div",i,[Object(a["createVNode"])("div",n,[d,Object(a["createVNode"])("div",b,[u,Object(a["createVNode"])("div",m,[Object(a["createVNode"])("div",p,[te.carts.carts?(Object(a["openBlock"])(),Object(a["createBlock"])("ul",f,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(te.carts.carts,(function(t){return Object(a["openBlock"])(),Object(a["createBlock"])("li",{class:"list-group-item px-0",key:t.id},[Object(a["createVNode"])(re,{class:"d-flex w-100 flex-nowrap justify-content-between",to:"/product/".concat(t.product.id)},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])("img",{src:t.product.imageUrl,alt:t.product.title,class:"img-fluid img-size"},null,8,["src","alt"]),Object(a["createVNode"])("div",O,[Object(a["createVNode"])("div",j,[Object(a["createVNode"])("h5",V,Object(a["toDisplayString"])(t.product.title),1),t.coupon?(Object(a["openBlock"])(),Object(a["createBlock"])("small",g,[N,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(t.coupon.code),1)])):Object(a["createCommentVNode"])("",!0)]),Object(a["createVNode"])("div",v,[Object(a["createVNode"])("p",h,"x "+Object(a["toDisplayString"])(t.qty),1),Object(a["createVNode"])("p",x," $"+Object(a["toDisplayString"])(e.$filters.currency(t.product.price)),1)])])]})),_:2},1032,["to"])])})),128))])):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])("dl",y,[w,k,te.carts.final_total!==te.carts.total?(Object(a["openBlock"])(),Object(a["createBlock"])("dt",S,[B,$])):(Object(a["openBlock"])(),Object(a["createBlock"])("dt",C,"合計")),Object(a["createVNode"])("dd",T," $"+Object(a["toDisplayString"])(e.$filters.currency(te.carts.final_total)),1)])])])])])]),Object(a["createVNode"])("div",L,[M,Object(a["createVNode"])("div",E,[D,Object(a["createVNode"])(le,{onSubmit:ce.createOrder},{default:Object(a["withCtx"])((function(e){var c=e.errors;return[F,Object(a["createVNode"])("div",U,[A,Object(a["createVNode"])(oe,{id:"email",name:"email",type:"email",class:["form-control",{"is-invalid":c["email"],"is-valid":!c["email"]&&""!==te.user.email}],placeholder:"請輸入 Email",modelValue:te.user.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return te.user.email=e}),rules:"email|required"},null,8,["modelValue","class"]),Object(a["createVNode"])(se,{name:"email",class:"invalid-feedback"})]),Object(a["createVNode"])("div",q,[_,Object(a["createVNode"])(oe,{id:"name",name:"姓名",type:"text",class:["form-control",{"is-invalid":c["姓名"],"is-valid":""!==te.user.name&&!c["姓名"]}],placeholder:"請輸入姓名",rules:"required",modelValue:te.user.name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return te.user.name=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(se,{class:"invalid-feedback",name:"姓名"})]),Object(a["createVNode"])("div",I,[J,Object(a["createVNode"])(oe,{id:"tel",name:"電話",type:"tel",modelValue:te.user.tel,"onUpdate:modelValue":t[3]||(t[3]=function(e){return te.user.tel=e}),class:["form-control",{"is-invalid":c["電話"],"is-valid":!c["電話"]&&""!==te.user.tel}],placeholder:"請輸入電話",rules:"required|numeric|min:8"},null,8,["modelValue","class"]),Object(a["createVNode"])(se,{class:"invalid-feedback",name:"電話"})]),Object(a["createVNode"])("div",z,[G,Object(a["createVNode"])(oe,{id:"address",name:"地址",type:"text",class:["form-control",{"is-invalid":c["地址"],"is-valid":""!==te.user.address&&!c["地址"]}],placeholder:"請輸入地址",rules:"required",modelValue:te.user.address,"onUpdate:modelValue":t[4]||(t[4]=function(e){return te.user.address=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(se,{class:"invalid-feedback",name:"地址"})]),Object(a["createVNode"])("div",R,[H,Object(a["withDirectives"])(Object(a["createVNode"])("textarea",{name:"留言",class:"form-control",id:"message",placeholder:"請輸入留言",rows:"10","onUpdate:modelValue":t[5]||(t[5]=function(e){return te.message=e})},null,512),[[a["vModelText"],te.message]]),K]),te.carts.carts?(Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],{key:0},[P,Object(a["createVNode"])("div",Q,[Object(a["createVNode"])(re,{class:"btn btn-outline-primary",to:"/cart"},{default:Object(a["withCtx"])((function(){return[W,X]})),_:1}),Object(a["createVNode"])("div",{class:{"cursor-not-allowed":te.isEmpty}},[Object(a["createVNode"])("button",{class:"btn btn-primary",type:"submit",disabled:!te.carts.carts.length||te.isEmpty||0!==Object.keys(c).length},[Y,Z],8,["disabled"])],2)])],64)):Object(a["createCommentVNode"])("",!0)]})),_:1},8,["onSubmit"])])])])])])],64)}c("4de4");var te={data:function(){return{user:{email:"",tel:"",name:"",address:""},message:"",carts:{},isLoading:!1,isEmpty:!0}},inject:["$httpMessageState","emitter"],methods:{getCart:function(){var e=this;this.isLoading=!0;var t="/api/".concat("hsinyuuu","/cart");this.$http.get(t).then((function(t){if(!t.data.success)return e.$httpMessageState(t,"取得購物車列表"),void(e.isLoading=!1);e.carts=t.data.data,e.isLoading=!1})).catch((function(t){e.$httpMessageState(t,"連線錯誤"),e.isLoading=!1}))},createOrder:function(e,t){var c=this,a=t.resetForm,r="/api/".concat("hsinyuuu","/order"),o={user:this.user,message:this.message};this.carts.carts.length?this.$http.post(r,{data:o}).then((function(e){if(e.data.success){if(c.user={email:"",tel:"",name:"",address:""},c.message="",a(),c.carts.carts[0].coupon){var t=JSON.parse(localStorage.getItem("couponsGot"));t=t.filter((function(e){return e!==c.carts.carts[0].coupon.code})),localStorage.setItem("couponsGot",JSON.stringify(t))}c.getCart(),c.$httpMessageState(e,"建立訂單");var r=e.data.orderId;c.emitter.emit("update-cart"),c.$router.push("/checkout/".concat(r))}else c.$httpMessageState(e,"建立訂單")})).catch((function(e){c.$httpMessageState(e,"連線錯誤"),c.isLoading=!1})):this.$httpMessageState({data:{success:!1,message:"購物車無內容"}},"建立訂單")}},watch:{user:{handler:function(e){e.email&&e.tel&&e.name&&e.address&&(this.isEmpty=!1)},deep:!0}},mounted:function(){this.$http.defaults.baseURL="https://vue3-course-api.hexschool.io",this.getCart()}},ce=c("6b0d"),ae=c.n(ce);const re=ae()(te,[["render",ee]]);t["default"]=re},e8b5:function(e,t,c){var a=c("c6b6");e.exports=Array.isArray||function(e){return"Array"==a(e)}}}]);
//# sourceMappingURL=chunk-5021f872.5c07a4dd.js.map